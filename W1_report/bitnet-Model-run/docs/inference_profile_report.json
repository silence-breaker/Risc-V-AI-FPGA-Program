{
  "meta": {
    "report_title": "BitNet b1.58 模型 CPU 推理性能分析报告",
    "date": "2026年01月19日",
    "framework": "PyTorch (CPU only)",
    "model_path": "/home/silence_breaker/git/Risc-V-AI-FPGA-Program/W1_report/bitnet-Model-run/models/microsoftbitnet-b1.58-2B-4T-bf16",
    "prompt": "Microsoft is",
    "seq_len": 3
  },
  "system_info": {
    "date": "2026年01月19日",
    "platform": "Linux",
    "processor": "x86_64",
    "cpu_count": 16,
    "cpu_count_physical": 8,
    "memory_total_gb": 30.19,
    "python_version": "3.10.19",
    "torch_version": "2.5.1+cu121"
  },
  "model_info": {
    "structure": "BitNetForCausalLM(\n  (model): BitNetModel(\n    (embed_tokens): Embedding(128256, 2560)\n    (layers): ModuleList(\n      (0-29): 30 x BitNetDecoderLayer(\n        (self_attn): BitNetAttention(\n          (q_proj): AutoBitLinear(in_features=2560, out_features=2560, bias=False)\n          (k_proj): AutoBitLinear(in_features=2560, out_features=640, bias=False)\n          (v_proj): AutoBitLinear(in_features=2560, out_features=640, bias=False)\n          (o_proj): AutoBitLinear(in_features=2560, out_features=2560, bias=False)\n          (attn_sub_norm): BitNetRMSNorm((2560,), eps=1e-05)\n        )\n        (mlp): BitNetMLP(\n          (gate_proj): AutoBitLinear(in_features=2560, out_features=6912, bias=False)\n          (up_proj): AutoBitLinear(in_features=2560, out_features=6912, bias=False)\n          (down_proj): AutoBitLinear(in_features=6912, out_features=2560, bias=False)\n          (act_fn): ReLUSquaredActivation()\n          (ffn_sub_norm): BitNetRMSNorm((6912,), eps=1e-05)\n        )\n        (input_layernorm): BitNetRMSNorm((2560,), eps=1e-05)\n        (post_attention_layernorm): BitNetRMSNorm((2560,), eps=1e-05)\n      )\n    )\n    (norm): BitNetRMSNorm((2560,), eps=1e-05)\n    (rotary_emb): BitNetRotaryEmbedding()\n  )\n  (lm_head): Linear(in_features=2560, out_features=128256, bias=False)\n)",
    "num_layers": 30,
    "memory_loaded_mb": 9397.37
  },
  "inference_summary": {
    "total_time_ms": 4808.34,
    "total_ops_per_layer": 416808960,
    "avg_time_per_layer_ms": 50.32
  },
  "layer_distribution": {
    "mlp_time_ms": 40.68,
    "mlp_time_ratio": 80.8,
    "attn_time_ms": 9.65,
    "attn_time_ratio": 19.2,
    "nonlinear_time_ms": 0,
    "nonlinear_time_ratio": 0.0
  },
  "operator_stats": [
    {
      "Submodule": "down_proj",
      "Time (ms)": 13.128124827274185,
      "OPs": 106168320.0,
      "Mem Delta (MB)": 0.06734913793103449,
      "Effective GOPS": 8.087089466077533,
      "Time Ratio (%)": 26.087019953862654,
      "OPs Ratio (%)": 25.471698113207548
    },
    {
      "Submodule": "gate_proj",
      "Time (ms)": 14.056134413639766,
      "OPs": 106168320.0,
      "Mem Delta (MB)": 0.09078663793103449,
      "Effective GOPS": 7.553166245833319,
      "Time Ratio (%)": 27.931076505381697,
      "OPs Ratio (%)": 25.471698113207548
    },
    {
      "Submodule": "up_proj",
      "Time (ms)": 13.494580690192002,
      "OPs": 106168320.0,
      "Mem Delta (MB)": 0.07152478448275862,
      "Effective GOPS": 7.8674782445937135,
      "Time Ratio (%)": 26.81520783552313,
      "OPs Ratio (%)": 25.471698113207548
    },
    {
      "Submodule": "o_proj",
      "Time (ms)": 3.667827723708389,
      "OPs": 39321600.0,
      "Mem Delta (MB)": 0.0,
      "Effective GOPS": 10.720678003994024,
      "Time Ratio (%)": 7.288374865001809,
      "OPs Ratio (%)": 9.433962264150944
    },
    {
      "Submodule": "q_proj",
      "Time (ms)": 4.398858000309576,
      "OPs": 39321600.0,
      "Mem Delta (MB)": 0.0,
      "Effective GOPS": 8.939047361208905,
      "Time Ratio (%)": 8.741011982905611,
      "OPs Ratio (%)": 9.433962264150944
    },
    {
      "Submodule": "k_proj",
      "Time (ms)": 0.8644723447073845,
      "OPs": 9830400.0,
      "Mem Delta (MB)": 0.0,
      "Effective GOPS": 11.371560999244567,
      "Time Ratio (%)": 1.7178011027966729,
      "OPs Ratio (%)": 2.358490566037736
    },
    {
      "Submodule": "v_proj",
      "Time (ms)": 0.7143581377900334,
      "OPs": 9830400.0,
      "Mem Delta (MB)": 0.0,
      "Effective GOPS": 13.761164715518905,
      "Time Ratio (%)": 1.4195077545284194,
      "OPs Ratio (%)": 2.358490566037736
    }
  ],
  "layer0_data": [
    {
      "Layer Name": "model.layers.0.self_attn.q_proj",
      "Layer Num": 0,
      "Submodule": "q_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 3001.7167270016216,
      "OPs": 39321600,
      "Mem Delta (MB)": 138.125,
      "Abs Mem (MB)": 10053.4453125,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.0.self_attn.k_proj",
      "Layer Num": 0,
      "Submodule": "k_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 26.633272998878965,
      "OPs": 9830400,
      "Mem Delta (MB)": 0.125,
      "Abs Mem (MB)": 10053.5703125,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.0.self_attn.v_proj",
      "Layer Num": 0,
      "Submodule": "v_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 0.5461119981191587,
      "OPs": 9830400,
      "Mem Delta (MB)": 0.0,
      "Abs Mem (MB)": 10053.5703125,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.0.self_attn.o_proj",
      "Layer Num": 0,
      "Submodule": "o_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 2.6034809998236597,
      "OPs": 39321600,
      "Mem Delta (MB)": 6.25,
      "Abs Mem (MB)": 10061.3203125,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.0.mlp.gate_proj",
      "Layer Num": 0,
      "Submodule": "gate_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 38.3481649987516,
      "OPs": 106168320,
      "Mem Delta (MB)": 0.00390625,
      "Abs Mem (MB)": 10061.32421875,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.0.mlp.up_proj",
      "Layer Num": 0,
      "Submodule": "up_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 10.453950002556667,
      "OPs": 106168320,
      "Mem Delta (MB)": 0.30859375,
      "Abs Mem (MB)": 10061.6328125,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.0.mlp.down_proj",
      "Layer Num": 0,
      "Submodule": "down_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 102.96959300103481,
      "OPs": 106168320,
      "Mem Delta (MB)": 1.4453125,
      "Abs Mem (MB)": 10063.078125,
      "Input Shape": "[1, 3, 6912]"
    }
  ],
  "mid_layer_data": [
    {
      "Layer Name": "model.layers.14.self_attn.q_proj",
      "Layer Num": 14,
      "Submodule": "q_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 3.517369001201587,
      "OPs": 39321600,
      "Mem Delta (MB)": 0.0,
      "Abs Mem (MB)": 10063.26171875,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.14.self_attn.k_proj",
      "Layer Num": 14,
      "Submodule": "k_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 0.4930689974571578,
      "OPs": 9830400,
      "Mem Delta (MB)": 0.0,
      "Abs Mem (MB)": 10063.26171875,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.14.self_attn.v_proj",
      "Layer Num": 14,
      "Submodule": "v_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 0.40747599996393546,
      "OPs": 9830400,
      "Mem Delta (MB)": 0.0,
      "Abs Mem (MB)": 10063.26171875,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.14.self_attn.o_proj",
      "Layer Num": 14,
      "Submodule": "o_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 2.4372119987674523,
      "OPs": 39321600,
      "Mem Delta (MB)": 0.0,
      "Abs Mem (MB)": 10063.26171875,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.14.mlp.gate_proj",
      "Layer Num": 14,
      "Submodule": "gate_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 10.60718099688529,
      "OPs": 106168320,
      "Mem Delta (MB)": 0.0,
      "Abs Mem (MB)": 10063.203125,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.14.mlp.up_proj",
      "Layer Num": 14,
      "Submodule": "up_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 10.852528001123574,
      "OPs": 106168320,
      "Mem Delta (MB)": 0.05859375,
      "Abs Mem (MB)": 10063.26171875,
      "Input Shape": "[1, 3, 2560]"
    },
    {
      "Layer Name": "model.layers.14.mlp.down_proj",
      "Layer Num": 14,
      "Submodule": "down_proj",
      "Type": "AutoBitLinear",
      "Time (ms)": 10.513723002077313,
      "OPs": 106168320,
      "Mem Delta (MB)": 0.0,
      "Abs Mem (MB)": 10063.1953125,
      "Input Shape": "[1, 3, 6912]"
    }
  ],
  "raw_data_file": "raw_layer_data.csv"
}